#!/usr/bin/env bashset -euo pipefail# ConfigPG_CONN='PG:"host=db dbname=gis user=postgres password=password"'GEOM_NAME="geom"# Lista bacini -> file gpkgdeclare -A GPKGGPKG[biferno]="/tmp/biferno.gpkg"GPKG[fortore]="/tmp/fortore.gpkg"GPKG[saccione]="/tmp/saccione.gpkg"GPKG[trigno]="/tmp/trigno.gpkg"GPKG[volturno]="/tmp/volturno.gpkg"sanitize() {  # lower + replace non-alnum with underscore  echo "$1" | tr '[:upper:]' '[:lower:]' | sed -E 's/[^a-z0-9_]+/_/g' | sed -E 's/^_+|_+$//g'}list_layers() {  local gpkg="$1"  ogrinfo -ro -so "$gpkg" \    | awk -F': ' '/^[0-9]+: /{name=$2; sub(/ \(.*/, "", name); print name}'}for basin in "${!GPKG[@]}"; do  gpkg="${GPKG[$basin]}"  if [ ! -f "$gpkg" ]; then    echo "SKIP: $basin (missing $gpkg)"    continue  fi  echo "=== BASIN: $basin ==="  while IFS= read -r layer; do    [ -n "$layer" ] || continue    t_layer="$(sanitize "$layer")"    table="pai_${basin}__${t_layer}"    echo "IMPORT: $layer -> $table"    ogr2ogr -f PostgreSQL \      "$PG_CONN" \      "$gpkg" \      -nln "$table" \      -nlt PROMOTE_TO_MULTI \      -lco GEOMETRY_NAME="$GEOM_NAME" \      -overwrite \      "$layer"  done < <(list_layers "$gpkg")doneecho "DONE"